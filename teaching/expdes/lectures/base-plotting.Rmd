---
title: "Plotting in R"
author: "Heath Blackmon"
date: '2022-09-18'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Basic plotting functions

We will use a variety of basic R functions for plotting the most important of these being `plot`, `barplot`, `hist`, and `boxplot`. We will also use a variety of additional functions that allow us to add things to our basic plot like `abline`, `points`, and `text`.

## Plotting two continuous variables

To illustrate plotting we wil use the dataset `iris`.

```{r}
data(iris)
```

We can make a simple plot using nothing more than our basic function `plot` and identifying the x and y variable:

```{r}
plot(x = iris$Sepal.Length,
     y = iris$Petal.Length)
```

Now obviously there is a lot that is incomplete about this plot. We can fix most of these by using additional arguments in the plot function:

```{r}
cols <- c(rgb(1, 0, 0, .5),
          rgb(0, 1, 0, .5),
          rgb(0, 0, 1, .5))
plot(x = iris$Sepal.Length,
     y = iris$Petal.Length,
     xlab = "Sepal length (cm)",
     ylab = "Petal length (cm)",
     cex = .95,
     col = cols[as.numeric(iris$Species)],
     pch = 16,
     main = "Iris Morphology",
     cex.axis = .85,
     cex.lab = .7)
x <- 7.2
y <- c(3, 2.5, 2)
sp <- c("setosa", "versicolor", "virginica")
for(i in 1:3){
  points(x = x, y = y[i], pch = 16,
         cex = 1.3, col = cols[i])
  text(x = x, y = y[i], sp[i], 
       pos = 4, cex = 0.7)
}
```

## Barplots

Barplots are most useful for count data where you have a single value for several categories for instance:

```{r}
dat <- c(34, 456, 232)
names(dat) <- c("site 1", "site 2", "site 3")
barplot(dat, names.arg = c("LT", "Heath", "Jen"),
        ylim = c(0, 500))
text(x = .7, y = 55, "a", cex = .7)
text(x = 3.1, y = 255, "b", cex = .7)
text(x = 1.9, y = 476, "b", cex = .7)

```

# Plotting distributions or 1000s of datapoints

Sometimes you will have many thousands of datapoints and you want to show how the values are distributed lets look at two approaches to doing that using `plot` and `hist`.

```{r}
# first lets make some data
x <- c(rnorm(200), rnorm(200, mean=3.5))

plot(density(x))

hist(x)
```

Now these are very simple plots if we were using these for a talk, poster, or publication we would want to do the same thing we did with our first plot and fine tune all aspects of the figure.


## Boxplots

Finally lets look at how to make the most of a boxplot.

```{r}
boxplot(iris[,1:4],cex.axis=.6)
```

## Alternative to boxplot

Try installing the R package beeswarm. I think this gives a much better option for plotting data like this:

```{r}
# I've already installed beeswarm so I just have to load it with the function library.
library(beeswarm)
beeswarm(iris[,1:4], cex=.5, pch=16)
```





hist(),
     breaks=10)





abline(h=2)

