52/4
2/13
1/36
1*.000000001
(1*.000000001)/.027
nodeage <- rnorm(mean=64.3, sd=7)
nodeage <- rnorm(mean=64.3, sd=7, n=10000)
hist(nodeage)
help(rexp)
help("rlogis")
hist(rlogis(n=1000, location = 0, scale = 1))
hist(rlogis(n=1000, location = 0, scale = 4))
hist(rlnorm(n=1000, location = 0, scale = 4))
hist(rlnorm(n=1000, meanlog = 0, sdlog = 4))
hist(rlnorm(n=1000, meanlog = 0, sdlog = 1))
hist(rlnorm(n=1000, meanlog = 0, sdlog = 2))
hist(rlnorm(n=1000, meanlog = 0, sdlog = .2))
hist(rlnorm(n=1000, meanlog = 65, sdlog = .2))
hist(rlnorm(n=1000, meanlog = 2, sdlog = .2))
hist(rlnorm(n=1000, meanlog = 4, sdlog = .2))
hist(rgamma(n=1000, shape = 4, rate = .2))
hist(rgamma(n=1000, shape = 6, rate = .2))
hist(rgamma(n=1000, shape = 6, rate = .2)mxlim=c(0,200))
hist(rgamma(n=1000, shape = 6, rate = .2), xlim=c(0,200))
hist(rgamma(n=1000, shape = 4, rate = .2), xlim=c(0,200))
hist(rgamma(n=1000, shape = 2, rate = .2), xlim=c(0,200))
hist(rgamma(n=1000, shape = 2, rate = .5), xlim=c(0,200))
hist(rgamma(n=1000, shape = 6, rate = .5), xlim=c(0,200))
hist(rgamma(n=1000, shape = 10, rate = .5), xlim=c(0,200))
hist(rgamma(n=1000, shape = 20, rate = .5), xlim=c(0,200))
hist(rgamma(n=1000, shape = 20, rate = 5), xlim=c(0,200))
hist(rgamma(n=1000, shape = 20, rate = .01), xlim=c(0,200))
hist(rgamma(n=1000, shape = 20, rate = .1), xlim=c(0,200))
hist(rgamma(n=1000, shape = 20, rate = .3), xlim=c(0,200))
hist(rgamma(n=1000, shape = 25, rate = .3), xlim=c(0,200))
library(evobiR)
plot(density(prior))
nodeage <- rnorm(mean=64.3, sd=7, n=1000)
prior <- rgamma(n=1000, shape = 25, rate = .3), xlim=c(0,200))
plot(density(prior))
prior <- rgamma(n=1000, shape = 25, rate = .3)
plot(density(prior))
prior <- rgamma(n=10000, shape = 25, rate = .3)
plot(density(prior))
prior <- rgamma(n=100000, shape = 25, rate = .3)
plot(density(prior))
plot(density(prior),bw=.2)
plot(density(prior,bw=.2))
hist(prior)
prior <- rgamma(n=100000, shape = 25, rate = .13)
hist(prior)
prior <- rgamma(n=100000, shape = 25, rate = .03)
prior <- rgamma(n=100000, shape = 5, rate = .03)
hist(prior)
prior <- rgamma(n=100000, shape = 3, rate = .03)
hist(prior)
prior <- rgamma(n=100000, shape = 3, rate = .3)
hist(prior)
plot(density(prior,bw=.2))
prior <- rgamma(n=100000, shape = 3, rate = .3)+50
hist(prior)
plot(density(prior,bw=.2))
plot(density(nodeage,bw=.2))
nodeage <- rnorm(mean=64.3, sd=7, n=10000)
prior <- rgamma(n=100000, shape = 3, rate = .3)+50
hist(prior)
plot(density(prior,bw=.2))
plot(density(nodeage,bw=.2))
plot(density(nodeage,bw=1))
plot(density(prior,bw=.2))
plot(density(nodeage,bw=1))
nodeage <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=100000, shape = 3, rate = .3)+50
hist(prior)
plot(density(prior,bw=.2))
plot(density(nodeage,bw=1))
min(prior)
mean(prior)
x <- abs(prior-true.posterior)
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=100000, shape = 3, rate = .3)+50
x <- abs(prior-true.posterior)
range(x)
z <- x/max(x)
range(z)
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=100000, shape = 3, rate = .3)+50
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+50
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
plot(density(prior,bw=.2))
plot(density(first.posterior,bw=1))
plot(density(true.posterior,bw=1))
first.posterior <- first.posterior[first.posterior > min(prior)]
plot(density(prior,bw=.2))
plot(density(first.posterior,bw=1))
plot(density(true.posterior,bw=1))
plot(density(first.posterior,bw=1))
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+55
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
first.posterior <- first.posterior[first.posterior > min(prior)]
plot(density(prior,bw=.2))
plot(density(first.posterior,bw=1))
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+60
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
first.posterior <- first.posterior[first.posterior > min(prior)]
plot(density(prior,bw=.2))
plot(density(first.posterior,bw=1))
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+65
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
first.posterior <- first.posterior[first.posterior > min(prior)]
plot(density(prior,bw=.2))
plot(density(first.posterior,bw=1))
plot(density(true.posterior,bw=1))
plot(density(prior,bw=.2))
plot(density(prior,bw=.8))
plot(density(first.posterior,bw=1))
plot(density(prior,bw=.8))
lines(density(first.posterior,bw=1))
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+65
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
first.posterior <- first.posterior[first.posterior > min(prior)+1]
plot(density(prior,bw=.8))
lines(density(first.posterior,bw=1))
plot(density(prior,bw=.8),ylim=c0,.2)
plot(density(prior,bw=.8),ylim=c(0,.2)
lines(density(first.posterior,bw=1))
plot(density(true.posterior,bw=1))
library(evobiR)
plot(density(prior,bw=.8),ylim=c(0,.2)
lines(density(first.posterior,bw=1))
plot(density(true.posterior,bw=1))
library(evobiR)
plot(density(prior,bw=.8),ylim=c(0,.2))
lines(density(first.posterior,bw=1))
plot(density(prior,bw=.8),ylim=c(0,.2), main="Node Age")
plot(density(prior,bw=.8),ylim=c(0,.2), main="Node Age", xlab="Millions of years")
lines(density(first.posterior,bw=1))
plot(density(prior,bw=.8),ylim=c(0,.2), main="Node Age", xlab="Millions of years")
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years"
lwd=2,
col="red")
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red")
lines(density(first.posterior,bw=1), col="darkgreen")
lines(density(first.posterior,bw=1), col="darkgreen", lwd=3)
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red")
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(true.posterior,bw=1))
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red")
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="pink",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="green", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="pink",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="lightgreen", lwd=2)
new.prior <- rnorm(n=10000, mean=70, sd=6)
plot(density(new.prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="pink",xlim=c(30,120))
new.prior <- rnorm(n=10000, mean=70, sd=12)
plot(density(new.prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.1),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
new.prior <- rnorm(n=100000, mean=70, sd=12)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
true.posterior <- rnorm(mean=60.3, sd=7, n=10000)
prior <- rgamma(n=10000, shape = 3, rate = .3)+65
new.prior <- rnorm(n=100000, mean=70, sd=12)
x <- abs(prior-true.posterior)
z <- 1 - x/max(x)
first.posterior <- sample(true.posterior, 10000, replace=T, prob=z)
first.posterior <- first.posterior[first.posterior > min(prior)+1]
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,120))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,105))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,105))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
library(ape)
plot(rcoal(10))
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(rcoal(10),type="c")
plot(density(prior,bw=.8),ylim=c(0,.2),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,105))
lines(density(first.posterior,bw=1), col="darkgreen", lwd=2)
plot(density(new.prior,bw=.8),ylim=c(0,.08),
main="Node Age",
xlab="Millions of years",
lwd=2,
col="red",xlim=c(30,105))
lines(density(true.posterior,bw=1), col="darkgreen", lwd=2)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
sample(c("H","T"), replace=T, size=10)
30*50
p <- .5
n <- 100
x <- 50
frac <- factorial(n) / (factorial(n-x) * factorial(x))
ans <- frac * p^x * (1-p)^(n-x)
help(dbinom)
dbinom(50, size = 100, prob = .5)
x <- 0:100
dbinom(x, size = 100, prob = .5)
x <- 0:100
y <- dbinom(x, size = 100, prob = .5)
hist(y)
plot(y~x)
plot(y~x, pch=16)
plot(y~x, pch=16, cex=.5)
plot(y~x, pch=16, cex=.5, xlab="number of heads", ylab="density")
dbinom(23, size = 65, prob = .5)
dbinom(23, size = 65, prob = .5)
binom.test(23, size = 65, prob = .5)
help(binom.test)
binom.test(x = 23, n = 65, p = .5)
binom.test(x = 23, n = 65, p = .5, alternative = "t")
binom.test(x = 23, n = 65, p = .5, alternative = "t")
binom.test(x = 23, n = 65, p = .5, alternative = "g")
binom.test(x = 23, n = 65, p = .5, alternative = "l")
binom.test(x = 23, n = 65, p = .5, alternative = "t")
binom.test(x = 23, n = 65, p = .5, alternative = "g") #
binom.test(x = 23, n = 65, p = .5, alternative = "l") #
help(rbinom)
rbinom(n=2, size=10, prob=,5)
rbinom(n=10, size=2, prob=,5)
rbinom(n=10, size=2, prob=.5)
rbinom(n=65, size=1, prob=.5)
rbinom(n=1, size=65, prob=.5)
rbinom(n=2, size=65, prob=.5)
rbinom(n=10000, size=65, prob=.5)
x <- rbinom(n=10000, size=65, prob=.5)
sd(x)
x <- rbinom(n=100000, size=65, prob=.5)
sd(x)
x <- rbinom(n=100000, size=65, prob=.5)
sd(x)
x <- rbinom(n=100000, size=25, prob=.5)
sd(x)
x <- rbinom(n=100000, size=25, prob=.5)
sd(x)
x <- rbinom(n=100000, size=95, prob=.5)
sd(x)
x <- rbinom(n=100000, size=95, prob=.5)
sd(x)
z <- vector()
for(i in 1:400){
x <- rbinom(n=100000, size=95, prob=.5)
z[i] <- sd(x)
}
plot(z)
dbinom(x,65,.5)
x <- 0:65
dbinom(x,65,.5)
plot(dbinom(x,65,.5))
plot(dbinom(x,65,.5),type="l")
abline(v=23)
plot(dbinom(x,65,.5),type="l",xlim=c(15,45))
abline(v=23)
plot(dbinom(x,65,.5),type="l",xlim=c(20,45))
plot(dbinom(x,65,.5),type="l",xlim=c(20,47))
sqrt(65*.25)
1.96 * sqrt(65*.25)
65/2
32.5-23
9.5/7.901
.9937+.01241
binom.test(x = 23, n = 65, p = .5, alternative = "g") # p-value 0.99370
binom.test(x = 23, n = 65, p = .5, alternative = "l") # p-value 0.01241
23/65
binom.test(10, n = 50, p=0.5)
binom.test(x = 23, n = 65, p = .5, alternative = "t")
x <- rchisq(100, 5)
hist(x, prob=TRUE)
x <- rchisq(100000, 5)
hist(x, prob=TRUE)
help(rchisq)
x <- rchisq(100000, 5)
plot(density(x))
par(mfcol=c(3,1))
x <- rchisq(100000, 1)
plot(density(x))
x <- rchisq(100000, 2)
plot(density(x))
x <- rchisq(100000, 5)
plot(density(x))
par(mfcol=c(3,1))
x <- rchisq(100000, 1)
plot(density(x))
x <- rchisq(100000, 4)
plot(density(x))
x <- rchisq(100000, 10)
plot(density(x))
x <- rchisq(100000, 1)
plot(density(x),xlim=c(0,30))
x <- rchisq(100000, 4)
plot(density(x),xlim=c(0,30))
x <- rchisq(100000, 10)
plot(density(x),xlim=c(0,30))
62984825+65853516
Titanic
x <- matrix(,4,2)
x[1,] <- c(100, 50)
x[2,] <- c(20, 10)
x[3,] <- c(50, 24)
x[4,] <- c(95, 48)
x
chisq.test(x)
140+80+76+20
4+13+89+3
109/425
316+109
316/425
76+89
.7435294*144
.7435294*93
.7435294*165
.7435294*23
.2564706*144
.2564706*93
.2564706*165
.2564706*23
x
x <- c(140,80,76,20,4,13,89,3)
x
x <- matrix(c(140,80,76,20,4,13,89,3), 4, 2)
x
chisq.test(x=x)
