---
title: "Control structures"
author: "Heath Blackmon"
date: "3/8/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Control Structures

Control structures are one of the most basic and important aspects of any computer language. Today in R we will discuss: `for`, `if`, `while`, and, `apply`. 

## for

The function for is one of the most basic and important control strucutres it allows us to run a chunk of code a number of times. Here is a simple example:

```{r cars}
mytext <- "This is the number"
for(i in 1:10){
  print(paste(mytext, i))
}
```

In this example I wanted to print some text every time this is the text I stored in `mytext` I also wanted to add the current value of `i`. To do this i used the paste command to combine these two elements and then the print command to print this combined text to the screen. When we ran the code R got to the for command and then ran the code between the curly braces and ran it once with the variable `i` set to 1, then again with `i` set to 2, and repeated this process until it had run with i equals 10. 

Try making a loop that will print values between 12-18 to the screen.

## if

The function `if` allows us to run code only under certain conditions. It requires an argument that must be either TRUE or FALSE. Lets look at a simple example:

```{r}
# here we set up a counter
counter <- 0

# this is some simulated data from a normal distribution
dat <- rnorm(1000)

# this loop will examine each datapoint
for(i in 1:length(dat)){
  # this ask whether the current value is greater than 1
  if(dat[i]>1){
    # if the value is greater than one it adds one to our counter
    counter <- counter + 1
  }
}
# here I calculate the percentage of data that is greater than one
prop.large <- counter/length(dat) * 100
# now I print my result to the screen
print(paste(prop.large, "percent of my data is larger than 1"))
```


Why dont you try to make a chunk of code that will print to the screen the even numbers between 233 and 567.


## while

The function `while` is very useful because it allows us to run a chunk of code until some condition has been met. Like the `if` function it also requires an argument that is either TRUE or FALSE. Lets look at a simple example of using the while function

```{r}
# this variable acts like a flag we will repeat 
# our code till we have a met a condition then we
# will set this variable to FALSE to quite repeating
# the code
working <- TRUE
# this is just a counter
counter <- 1
while(working){
  x <- rpois(n=100, lambda=3)
  if(sum(x) > 320){
    working <- FALSE
  }
  counter <- counter + 1
}
print(paste("It took", counter, "draws from our Poisson distribution to recover a sample with a mean greater than 320"))

```

Try creating a block of code that will sample 100 number from a standard normal distribution until it gets a sample that contains a value greater than 3.5 and return this value as well as the number of attempts required.


## apply

The apply function is part of a family of functions designed to simplify running loops. You may have heard that R is slow when running loops and that you should use these functions instead of writing loops. This is actually not true. These functions actually are running loops as well though they can appear faster if your loop is poorly designed. The basic idea of these functions is that they will run some function that you choose to all of the elements of a list or all of the collumns or rows of a list. Lets look at an example of calculating the variance for several different variables in a data matrix:

```{r}
# this loads the dataset iris tha is included in R
data(iris)
# lets take a peak at this data
head(iris)

# ok lets calculate the variance of each
# morphological measures (the first 4 cols)
result <- apply(X = iris[,1:4], MARGIN = 2, FUN = var)
print(result)
```

Behind the scenes what R did was create a loop and run the `var` function on each of the specified columns of our data.

Try repeating this process but instead get the mean of each row of morhpological data.






